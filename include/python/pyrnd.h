#ifndef PYRND_H
 #define PYRND_H
#include <pthread.h>
#include <stdint.h>
// TODO Add thread in Python and callable object
#define _ENTROPY_NUMBER_OF_ELEMENTS 256
#define DISCRETE_LOG_MAX (8*_ENTROPY_NUMBER_OF_ELEMENTS)
#define LOG_DISCRETE_ARRAY (DISCRETE_LOG_MAX+1)

const uint32_t _log_discrete_array[]={
    2147483647,	999374,	908521,	855376,	817669,	788421,	764524,	744319,	726817,	711379,	697569,	685077,	673672,	663181,	653467,	644424,	635965,	628019,	620527,	613440,	606717,	600322,	594224,	588398,	582820,	577469,	572328,	567382,	562615,	558015,	553572,	549274,
	545113,	541079,	537166,	533367,	529675,	526083,	522588,	519183,	515865,	512628,	509470,	506386,	503372,	500427,	497546,	494727,	491968,	489265,	486617,	484021,	481476,	478979,	476529,	474124,	471763,	469443,	467163,	464923,	462720,	460553,	458422,	456325,
	454260,	452228,	450227,	448256,	446314,	444401,	442515,	440656,	438822,	437014,	435231,	433472,	431736,	430022,	428331,	426661,	425013,	423384,	421776,	420187,	418618,	417066,	415533,	414018,	412520,	411039,	409575,	408126,	406694,	405277,	403875,	402488,
	401115,	399757,	398413,	397082,	395765,	394460,	393169,	391890,	390624,	389370,	388127,	386897,	385677,	384469,	383272,	382086,	380910,	379745,	378591,	377446,	376311,	375186,	374070,	372964,	371867,	370780,	369701,	368631,	367570,	366517,	365472,	364436,
	363408,	362388,	361376,	360372,	359375,	358386,	357404,	356429,	355462,	354502,	353549,	352602,	351663,	350730,	349803,	348884,	347970,	347063,	346162,	345268,	344379,	343496,	342620,	341749,	340883,	340024,	339170,	338322,	337479,	336641,	335809,	334982,
	334160,	333344,	332532,	331726,	330924,	330127,	329335,	328548,	327765,	326987,	326214,	325445,	324681,	323921,	323166,	322415,	321668,	320925,	320187,	319453,	318722,	317996,	317274,	316556,	315842,	315131,	314424,	313722,	313023,	312327,	311636,	310948,
	310263,	309582,	308905,	308231,	307561,	306893,	306230,	305570,	304913,	304259,	303608,	302961,	302317,	301676,	301038,	300403,	299772,	299143,	298517,	297895,	297275,	296658,	296044,	295433,	294825,	294220,	293617,	293017,	292420,	291826,	291234,	290645,
	290058,	289474,	288893,	288315,	287738,	287165,	286594,	286025,	285459,	284895,	284334,	283775,	283218,	282664,	282112,	281563,	281015,	280470,	279928,	279387,	278849,	278313,	277779,	277247,	276717,	276190,	275665,	275141,	274620,	274101,	273584,	273069,
	272556,	272045,	271536,	271029,	270524,	270021,	269520,	269020,	268523,	268027,	267534,	267042,	266552,	266064,	265577,	265093,	264610,	264129,	263650,	263172,	262696,	262222,	261750,	261279,	260810,	260343,	259878,	259414,	258951,	258490,	258031,	257574,
	257118,	256664,	256211,	255760,	255310,	254862,	254415,	253970,	253527,	253085,	252644,	252205,	251767,	251331,	250896,	250463,	250031,	249601,	249172,	248744,	248318,	247893,	247470,	247047,	246627,	246207,	245789,	245372,	244957,	244543,	244130,	243718,
	243308,	242899,	242492,	242085,	241680,	241276,	240873,	240472,	240072,	239673,	239275,	238878,	238483,	238089,	237696,	237304,	236913,	236524,	236135,	235748,	235362,	234977,	234593,	234211,	233829,	233449,	233069,	232691,	232314,	231938,	231563,	231189,
	230816,	230444,	230073,	229703,	229335,	228967,	228600,	228235,	227870,	227507,	227144,	226782,	226422,	226062,	225704,	225346,	224989,	224634,	224279,	223925,	223572,	223220,	222870,	222520,	222170,	221822,	221475,	221129,	220783,	220439,	220095,	219753,
	219411,	219070,	218730,	218391,	218053,	217715,	217379,	217043,	216708,	216374,	216041,	215709,	215378,	215047,	214717,	214388,	214060,	213733,	213407,	213081,	212756,	212432,	212109,	211786,	211465,	211144,	210824,	210505,	210186,	209868,	209551,	209235,
	208920,	208605,	208291,	207978,	207665,	207354,	207043,	206732,	206423,	206114,	205806,	205499,	205192,	204886,	204581,	204277,	203973,	203670,	203367,	203066,	202765,	202465,	202165,	201866,	201568,	201270,	200973,	200677,	200382,	200087,	199793,	199499,
	199206,	198914,	198622,	198331,	198041,	197751,	197462,	197174,	196886,	196599,	196313,	196027,	195741,	195457,	195173,	194889,	194607,	194324,	194043,	193762,	193482,	193202,	192923,	192644,	192366,	192089,	191812,	191536,	191260,	190985,	190710,	190436,
	190163,	189890,	189618,	189346,	189075,	188805,	188535,	188265,	187997,	187728,	187460,	187193,	186927,	186660,	186395,	186130,	185865,	185601,	185338,	185075,	184812,	184551,	184289,	184028,	183768,	183508,	183249,	182990,	182732,	182474,	182217,	181960,
	181704,	181448,	181193,	180938,	180684,	180430,	180177,	179924,	179672,	179420,	179169,	178918,	178667,	178417,	178168,	177919,	177671,	177423,	177175,	176928,	176681,	176435,	176190,	175944,	175700,	175455,	175211,	174968,	174725,	174483,	174240,	173999,
	173758,	173517,	173277,	173037,	172797,	172558,	172320,	172082,	171844,	171607,	171370,	171134,	170898,	170662,	170427,	170192,	169958,	169724,	169491,	169258,	169025,	168793,	168561,	168330,	168099,	167868,	167638,	167409,	167179,	166950,	166722,	166494,
	166266,	166038,	165811,	165585,	165359,	165133,	164908,	164683,	164458,	164234,	164010,	163786,	163563,	163340,	163118,	162896,	162675,	162453,	162233,	162012,	161792,	161572,	161353,	161134,	160915,	160697,	160479,	160261,	160044,	159827,	159611,	159395,
	159179,	158964,	158749,	158534,	158320,	158106,	157892,	157679,	157466,	157253,	157041,	156829,	156617,	156406,	156195,	155985,	155774,	155565,	155355,	155146,	154937,	154728,	154520,	154312,	154105,	153898,	153691,	153484,	153278,	153072,	152866,	152661,
	152456,	152251,	152047,	151843,	151639,	151436,	151233,	151030,	150828,	150626,	150424,	150222,	150021,	149820,	149620,	149419,	149219,	149020,	148820,	148621,	148423,	148224,	148026,	147828,	147631,	147433,	147237,	147040,	146844,	146647,	146452,	146256,
	146061,	145866,	145671,	145477,	145283,	145089,	144896,	144703,	144510,	144317,	144125,	143933,	143741,	143550,	143358,	143167,	142977,	142786,	142596,	142406,	142217,	142028,	141839,	141650,	141461,	141273,	141085,	140898,	140710,	140523,	140336,	140150,
	139964,	139777,	139592,	139406,	139221,	139036,	138851,	138667,	138482,	138298,	138115,	137931,	137748,	137565,	137383,	137200,	137018,	136836,	136654,	136473,	136292,	136111,	135930,	135750,	135570,	135390,	135210,	135031,	134851,	134672,	134494,	134315,
	134137,	133959,	133781,	133604,	133427,	133250,	133073,	132896,	132720,	132544,	132368,	132193,	132017,	131842,	131667,	131493,	131318,	131144,	130970,	130796,	130623,	130450,	130277,	130104,	129931,	129759,	129587,	129415,	129243,	129072,	128901,	128730,
	128559,	128388,	128218,	128048,	127878,	127708,	127539,	127369,	127200,	127032,	126863,	126695,	126527,	126359,	126191,	126023,	125856,	125689,	125522,	125356,	125189,	125023,	124857,	124691,	124525,	124360,	124195,	124030,	123865,	123701,	123536,	123372,
	123208,	123044,	122881,	122718,	122554,	122391,	122229,	122066,	121904,	121742,	121580,	121418,	121257,	121095,	120934,	120773,	120613,	120452,	120292,	120132,	119972,	119812,	119652,	119493,	119334,	119175,	119016,	118857,	118699,	118541,	118383,	118225,
	118067,	117910,	117753,	117596,	117439,	117282,	117126,	116969,	116813,	116657,	116501,	116346,	116190,	116035,	115880,	115725,	115571,	115416,	115262,	115108,	114954,	114800,	114647,	114493,	114340,	114187,	114034,	113881,	113729,	113577,	113424,	113272,
	113121,	112969,	112818,	112666,	112515,	112364,	112214,	112063,	111913,	111762,	111612,	111462,	111313,	111163,	111014,	110865,	110716,	110567,	110418,	110270,	110121,	109973,	109825,	109677,	109529,	109382,	109235,	109087,	108940,	108794,	108647,	108500,
	108354,	108208,	108062,	107916,	107770,	107625,	107479,	107334,	107189,	107044,	106899,	106755,	106610,	106466,	106322,	106178,	106034,	105890,	105747,	105604,	105460,	105317,	105175,	105032,	104889,	104747,	104605,	104463,	104321,	104179,	104037,	103896,
	103754,	103613,	103472,	103331,	103191,	103050,	102910,	102769,	102629,	102489,	102350,	102210,	102070,	101931,	101792,	101653,	101514,	101375,	101236,	101098,	100960,	100821,	100683,	100545,	100408,	100270,	100133,	99995,	99858,	99721,	99584,	99447,
	99311,	99174,	99038,	98902,	98766,	98630,	98494,	98359,	98223,	98088,	97953,	97818,	97683,	97548,	97413,	97279,	97144,	97010,	96876,	96742,	96608,	96475,	96341,	96208,	96074,	95941,	95808,	95675,	95543,	95410,	95278,	95145,
	95013,	94881,	94749,	94617,	94486,	94354,	94223,	94091,	93960,	93829,	93698,	93568,	93437,	93307,	93176,	93046,	92916,	92786,	92656,	92526,	92397,	92267,	92138,	92009,	91880,	91751,	91622,	91493,	91365,	91236,	91108,	90980,
	90852,	90724,	90596,	90468,	90341,	90213,	90086,	89959,	89832,	89705,	89578,	89451,	89325,	89198,	89072,	88946,	88820,	88694,	88568,	88442,	88316,	88191,	88066,	87940,	87815,	87690,	87565,	87440,	87316,	87191,	87067,	86943,
	86818,	86694,	86570,	86447,	86323,	86199,	86076,	85952,	85829,	85706,	85583,	85460,	85337,	85215,	85092,	84970,	84847,	84725,	84603,	84481,	84359,	84237,	84116,	83994,	83873,	83752,	83630,	83509,	83388,	83267,	83147,	83026,
	82905,	82785,	82665,	82545,	82424,	82305,	82185,	82065,	81945,	81826,	81706,	81587,	81468,	81349,	81230,	81111,	80992,	80873,	80755,	80636,	80518,	80400,	80282,	80164,	80046,	79928,	79810,	79692,	79575,	79458,	79340,	79223,
	79106,	78989,	78872,	78755,	78639,	78522,	78406,	78289,	78173,	78057,	77941,	77825,	77709,	77593,	77478,	77362,	77247,	77132,	77016,	76901,	76786,	76671,	76556,	76442,	76327,	76213,	76098,	75984,	75870,	75755,	75641,	75527,
	75414,	75300,	75186,	75073,	74959,	74846,	74733,	74620,	74507,	74394,	74281,	74168,	74055,	73943,	73830,	73718,	73606,	73494,	73381,	73269,	73158,	73046,	72934,	72823,	72711,	72600,	72488,	72377,	72266,	72155,	72044,	71933,
	71822,	71712,	71601,	71491,	71380,	71270,	71160,	71050,	70940,	70830,	70720,	70610,	70501,	70391,	70282,	70172,	70063,	69954,	69845,	69736,	69627,	69518,	69409,	69301,	69192,	69084,	68975,	68867,	68759,	68651,	68543,	68435,
	68327,	68219,	68112,	68004,	67896,	67789,	67682,	67575,	67467,	67360,	67253,	67147,	67040,	66933,	66826,	66720,	66614,	66507,	66401,	66295,	66189,	66083,	65977,	65871,	65765,	65660,	65554,	65448,	65343,	65238,	65132,	65027,
	64922,	64817,	64712,	64608,	64503,	64398,	64294,	64189,	64085,	63980,	63876,	63772,	63668,	63564,	63460,	63356,	63253,	63149,	63045,	62942,	62838,	62735,	62632,	62529,	62426,	62323,	62220,	62117,	62014,	61911,	61809,	61706,
	61604,	61501,	61399,	61297,	61195,	61093,	60991,	60889,	60787,	60685,	60584,	60482,	60381,	60279,	60178,	60077,	59976,	59874,	59773,	59673,	59572,	59471,	59370,	59270,	59169,	59068,	58968,	58868,	58768,	58667,	58567,	58467,
	58367,	58267,	58168,	58068,	57968,	57869,	57769,	57670,	57571,	57471,	57372,	57273,	57174,	57075,	56976,	56877,	56779,	56680,	56581,	56483,	56384,	56286,	56188,	56089,	55991,	55893,	55795,	55697,	55599,	55502,	55404,	55306,
	55209,	55111,	55014,	54917,	54819,	54722,	54625,	54528,	54431,	54334,	54237,	54140,	54044,	53947,	53851,	53754,	53658,	53561,	53465,	53369,	53273,	53177,	53081,	52985,	52889,	52793,	52697,	52602,	52506,	52411,	52315,	52220,
	52125,	52029,	51934,	51839,	51744,	51649,	51554,	51460,	51365,	51270,	51175,	51081,	50986,	50892,	50798,	50703,	50609,	50515,	50421,	50327,	50233,	50139,	50046,	49952,	49858,	49765,	49671,	49578,	49484,	49391,	49298,	49204,
	49111,	49018,	48925,	48832,	48739,	48647,	48554,	48461,	48369,	48276,	48184,	48091,	47999,	47907,	47814,	47722,	47630,	47538,	47446,	47354,	47263,	47171,	47079,	46988,	46896,	46804,	46713,	46622,	46530,	46439,	46348,	46257,
	46166,	46075,	45984,	45893,	45802,	45711,	45621,	45530,	45440,	45349,	45259,	45168,	45078,	44988,	44898,	44807,	44717,	44627,	44538,	44448,	44358,	44268,	44178,	44089,	43999,	43910,	43820,	43731,	43642,	43552,	43463,	43374,
	43285,	43196,	43107,	43018,	42929,	42840,	42752,	42663,	42575,	42486,	42398,	42309,	42221,	42132,	42044,	41956,	41868,	41780,	41692,	41604,	41516,	41428,	41340,	41253,	41165,	41078,	40990,	40903,	40815,	40728,	40640,	40553,
	40466,	40379,	40292,	40205,	40118,	40031,	39944,	39857,	39771,	39684,	39597,	39511,	39424,	39338,	39252,	39165,	39079,	38993,	38907,	38821,	38735,	38649,	38563,	38477,	38391,	38305,	38220,	38134,	38048,	37963,	37877,	37792,
	37707,	37621,	37536,	37451,	37366,	37281,	37196,	37111,	37026,	36941,	36856,	36771,	36687,	36602,	36517,	36433,	36348,	36264,	36179,	36095,	36011,	35927,	35843,	35758,	35674,	35590,	35506,	35423,	35339,	35255,	35171,	35088,
	35004,	34920,	34837,	34753,	34670,	34587,	34503,	34420,	34337,	34254,	34171,	34088,	34005,	33922,	33839,	33756,	33673,	33591,	33508,	33425,	33343,	33260,	33178,	33095,	33013,	32931,	32848,	32766,	32684,	32602,	32520,	32438,
	32356,	32274,	32192,	32110,	32029,	31947,	31865,	31784,	31702,	31621,	31539,	31458,	31377,	31295,	31214,	31133,	31052,	30971,	30890,	30809,	30728,	30647,	30566,	30485,	30404,	30324,	30243,	30163,	30082,	30002,	29921,	29841,
	29760,	29680,	29600,	29520,	29440,	29359,	29279,	29199,	29119,	29040,	28960,	28880,	28800,	28720,	28641,	28561,	28482,	28402,	28323,	28243,	28164,	28085,	28005,	27926,	27847,	27768,	27689,	27610,	27531,	27452,	27373,	27294,
	27215,	27136,	27058,	26979,	26901,	26822,	26743,	26665,	26587,	26508,	26430,	26352,	26273,	26195,	26117,	26039,	25961,	25883,	25805,	25727,	25649,	25571,	25494,	25416,	25338,	25261,	25183,	25106,	25028,	24951,	24873,	24796,
	24719,	24641,	24564,	24487,	24410,	24333,	24256,	24179,	24102,	24025,	23948,	23871,	23794,	23718,	23641,	23564,	23488,	23411,	23335,	23258,	23182,	23106,	23029,	22953,	22877,	22801,	22724,	22648,	22572,	22496,	22420,	22344,
	22269,	22193,	22117,	22041,	21965,	21890,	21814,	21739,	21663,	21588,	21512,	21437,	21361,	21286,	21211,	21136,	21060,	20985,	20910,	20835,	20760,	20685,	20610,	20535,	20461,	20386,	20311,	20236,	20162,	20087,	20012,	19938,
	19863,	19789,	19715,	19640,	19566,	19492,	19417,	19343,	19269,	19195,	19121,	19047,	18973,	18899,	18825,	18751,	18677,	18603,	18530,	18456,	18382,	18309,	18235,	18162,	18088,	18015,	17941,	17868,	17795,	17721,	17648,	17575,
	17502,	17429,	17356,	17282,	17209,	17137,	17064,	16991,	16918,	16845,	16772,	16700,	16627,	16554,	16482,	16409,	16337,	16264,	16192,	16119,	16047,	15975,	15902,	15830,	15758,	15686,	15614,	15542,	15470,	15398,	15326,	15254,
	15182,	15110,	15038,	14966,	14895,	14823,	14751,	14680,	14608,	14537,	14465,	14394,	14322,	14251,	14180,	14108,	14037,	13966,	13895,	13824,	13752,	13681,	13610,	13539,	13468,	13398,	13327,	13256,	13185,	13114,	13044,	12973,
	12902,	12832,	12761,	12691,	12620,	12550,	12479,	12409,	12338,	12268,	12198,	12128,	12058,	11987,	11917,	11847,	11777,	11707,	11637,	11567,	11497,	11428,	11358,	11288,	11218,	11149,	11079,	11009,	10940,	10870,	10801,	10731,
	10662,	10592,	10523,	10454,	10384,	10315,	10246,	10177,	10107,	10038,	9969,	9900,	9831,	9762,	9693,	9624,	9556,	9487,	9418,	9349,	9280,	9212,	9143,	9075,	9006,	8937,	8869,	8800,	8732,	8664,	8595,	8527,
	8459,	8390,	8322,	8254,	8186,	8118,	8050,	7982,	7914,	7846,	7778,	7710,	7642,	7574,	7506,	7439,	7371,	7303,	7236,	7168,	7100,	7033,	6965,	6898,	6830,	6763,	6696,	6628,	6561,	6494,	6427,	6359,
	6292,	6225,	6158,	6091,	6024,	5957,	5890,	5823,	5756,	5689,	5622,	5556,	5489,	5422,	5355,	5289,	5222,	5156,	5089,	5023,	4956,	4890,	4823,	4757,	4690,	4624,	4558,	4492,	4425,	4359,	4293,	4227,
	4161,	4095,	4029,	3963,	3897,	3831,	3765,	3699,	3633,	3568,	3502,	3436,	3370,	3305,	3239,	3174,	3108,	3043,	2977,	2912,	2846,	2781,	2715,	2650,	2585,	2520,	2454,	2389,	2324,	2259,	2194,	2129,
	2064,	1999,	1934,	1869,	1804,	1739,	1674,	1609,	1545,	1480,	1415,	1350,	1286,	1221,	1157,	1092,	1028,	963,	899,	834,	770,	705,	641,	577,	513,	448,	384,	320,	256,	192,	128,	64,
	0
};

_Static_assert((sizeof(_log_discrete_array)/sizeof(_log_discrete_array[0]))==LOG_DISCRETE_ARRAY, "_log_discrete_array size error");

typedef struct _pyrnd_thread {
    int err;
    unsigned int number_of_threads;
    const char *error_message;
    pthread_t *thr;
} PYRND_THREAD;

typedef struct rand_entropy_t {
	uint8_t __rand_data[DISCRETE_LOG_MAX];
    uint32_t __entropy_val[_ENTROPY_NUMBER_OF_ELEMENTS];
} RAND_ENTROPY;

#endif